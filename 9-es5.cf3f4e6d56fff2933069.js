function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{xQww:function(e,t,n){"use strict";n.r(t);var r,i,a=n("tyNb"),o=n("dDmP"),s=n("2Vo4"),c=n("LRne"),u=n("lJxs"),l=n("vkgz"),f=n("fXoL"),h=n("aSmc"),d=((r=function(){function e(t){_classCallCheck(this,e),this.faker=t,this.status=this.faker.status,this.status$=this.status.asObservable(),this.user=this.faker.user.getValue()}return _createClass(e,[{key:"getStatus",value:function(e){return Object(c.a)(this.status.getValue().find((function(t){return t.id===e})))}},{key:"createStatus",value:function(e){var t=e.text,n={id:(new Date).getTime().toString(),created:new Date,author:this.user,text:t};return this.faker.addStatus(n),Object(c.a)(!0)}},{key:"createComment",value:function(e){var t=this,n=e.statusId,r=e.text,i={id:(new Date).getTime().toString(),created:new Date,author:this.user,text:r};return this.getStatus(n).pipe(Object(u.a)((function(e){var t=[].concat(_toConsumableArray(e.comments||[]),[i]);return Object.assign(Object.assign({},e),{comments:t,commentCount:t.length})})),Object(l.a)((function(e){return t.faker.updateStatus(e)})))}},{key:"deleteComment",value:function(e){var t=this,n=e.statusId;return this.getStatus(n).pipe(Object(u.a)((function(e){return Object.assign({},e)})),Object(l.a)((function(e){console.log(e),t.faker.updateStatus(e)})))}},{key:"deleteStatus",value:function(e){var t=e.id;return this.faker.deleteStatus(t)}}],[{key:"prepComment",value:function(e){return Object.assign(Object.assign({},e),{author:Object.assign(Object.assign({},e.author),{path:"/profile/"+e.author.username}),buttons:[o.a.like({label:"Like"})]})}},{key:"prepStatus",value:function(t){var n=t.comments,r=void 0===n?[]:n;return Object.assign(Object.assign({},t),{author:Object.assign(Object.assign({},t.author),{path:"/profile/"+t.author.username}),path:"/feed/"+t.id,comments:r.length?r.map((function(t){return e.prepComment(t)})):null,buttons:[o.a.like({label:"Like"}),o.a.comment({label:(t.commentCount?t.commentCount:0)+" Comments",path:"/feed/"+t.id})]})}}]),e}()).\u0275fac=function(e){return new(e||r)(f.Zb(h.a))},r.\u0275prov=f.Lb({token:r,factory:r.\u0275fac,providedIn:"root"}),r),b=n("D0XW"),m=n("7o/Q"),p=n("EY2u"),v=n("HDdC"),y=((i=function(){function e(t,n,r){_classCallCheck(this,e),this.kind=t,this.value=n,this.error=r,this.hasValue="N"===t}return _createClass(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}},{key:"accept",value:function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return Object(c.a)(this.value);case"E":return e=this.error,new v.a((function(t){return t.error(e)}));case"C":return Object(p.b)()}var e;throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}()).completeNotification=new i("C"),i.undefinedValueNotification=new i("N",void 0),i);function g(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.a,r=(t=e)instanceof Date&&!isNaN(+t)?+e-n.now():Math.abs(e);return function(e){return e.lift(new k(r,n))}}var k=function(){function e(t,n){_classCallCheck(this,e),this.delay=t,this.scheduler=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new C(e,this.delay,this.scheduler))}}]),e}(),C=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return _inherits(t,e),_createClass(t,[{key:"_schedule",value:function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}},{key:"scheduleNotification",value:function(e){if(!0!==this.errored){var t=this.scheduler,n=new O(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}}},{key:"_next",value:function(e){this.scheduleNotification(y.createNext(e))}},{key:"_error",value:function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleNotification(y.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var a=Math.max(0,n[0].time-r.now());this.schedule(e,a)}else this.unsubscribe(),t.active=!1}}]),t}(m.a),O=function e(t,n){_classCallCheck(this,e),this.time=t,this.notification=n},_=n("ofXK");function w(e,t){if(1&e){var n=f.Wb();f.Vb(0,"ui-comment",5),f.dc("action",(function(e){return f.sc(n),f.fc(2).handleAction(e)})),f.Ub()}if(2&e){var r=t.$implicit,i=f.fc(2);f.lc("comment",r)("deleteButton",r.author.id===i.user.id)}}function j(e,t){if(1&e&&(f.Tb(0),f.zc(1,w,1,2,"ui-comment",4),f.Sb()),2&e){var n=t.ngIf;f.Bb(1),f.lc("ngForOf",n)}}var S,I=((S=function(){function e(t,n){_classCallCheck(this,e),this.service=t,this.ui=n,this.reset=new s.a(!0),this.reset$=this.reset.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){this.ui.setMetaData({title:"Feed"}),this.statuses$=this.service.status$.pipe(Object(u.a)((function(e){return e.map(d.prepStatus)}))),this.user=this.service.user}},{key:"createStatus",value:function(e){var t=this,n=e.payload;return this.service.createStatus(n).pipe(g(100),Object(l.a)((function(){return t.reset.next(!0)}))).subscribe()}},{key:"handleAction",value:function(e){var t=e.type,n=e.payload;switch(t){case"DELETE":return this.service.deleteStatus(n);case"LIKE":return console.log("LIKE not implemented yet");default:console.log("Unhandled action ".concat(t),n)}}}]),e}()).\u0275fac=function(e){return new(e||S)(f.Pb(d),f.Pb(o.j))},S.\u0275cmp=f.Jb({type:S,selectors:[["ng-component"]],decls:7,vars:5,consts:[[1,"row"],[1,"col-12","col-md-8","offset-md-2"],["placeholder","What's happening?","submitButton","Post",1,"mb-3",3,"avatar","reset$","action"],[4,"ngIf"],["class","mb-3",3,"comment","deleteButton","action",4,"ngFor","ngForOf"],[1,"mb-3",3,"comment","deleteButton","action"]],template:function(e,t){1&e&&(f.Vb(0,"div",0),f.Vb(1,"div",1),f.Vb(2,"ui-card"),f.Vb(3,"ui-card-body"),f.Vb(4,"ui-comment-form",2),f.dc("action",(function(e){return t.createStatus(e)})),f.Ub(),f.zc(5,j,2,1,"ng-container",3),f.gc(6,"async"),f.Ub(),f.Ub(),f.Ub(),f.Ub()),2&e&&(f.Bb(4),f.lc("avatar",t.user.avatar)("reset$",t.reset$),f.Bb(1),f.lc("ngIf",f.hc(6,3,t.statuses$)))},directives:[o.e,o.d,o.m,_.m,_.l,o.l],pipes:[_.b],encapsulation:2}),S),E=n("eIep");function P(e,t){1&e&&(f.Vb(0,"div",7),f.Bc(1," No comments yet! Be the first to leave a comment! "),f.Ub())}function V(e,t){if(1&e){var n=f.Wb();f.Tb(0),f.Vb(1,"ui-comment",3),f.dc("action",(function(e){f.sc(n);var r=t.$implicit,i=f.fc().ngIf;return f.fc().deleteComment(i.id,r.id)})),f.Ub(),f.Sb()}if(2&e){var r=t.$implicit,i=f.fc(2);f.Bb(1),f.lc("comment",r)("deleteButton",r.author.id===i.user.id)}}function B(e,t){if(1&e){var n=f.Wb();f.Tb(0),f.Vb(1,"ui-comment",3),f.dc("action",(function(e){return f.sc(n),f.fc().handleStatusAction(e)})),f.Ub(),f.Vb(2,"h4"),f.Bc(3,"Comments"),f.Ub(),f.zc(4,P,2,0,"div",4),f.zc(5,V,2,2,"ng-container",5),f.Vb(6,"ui-comment-form",6),f.dc("action",(function(e){return f.sc(n),f.fc().createComment(e)})),f.Ub(),f.Sb()}if(2&e){var r=t.ngIf,i=f.fc();f.Bb(1),f.lc("comment",r)("deleteButton",r.author.id===i.user.id),f.Bb(3),f.lc("ngIf",!r.commentCount),f.Bb(1),f.lc("ngForOf",r.comments),f.Bb(1),f.lc("avatar",i.user.avatar)("reset$",i.reset$)}}var N,x=((N=function(){function e(t,n,r){_classCallCheck(this,e),this.route=t,this.router=n,this.service=r,this.reset=new s.a(!0),this.reset$=this.reset.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.user=this.service.user,this.data$=this.route.params.pipe(Object(u.a)((function(e){return e.id})),Object(l.a)((function(t){return e.id=t})),Object(E.a)((function(t){return e.service.getStatus(t).pipe(Object(u.a)(d.prepStatus))})))}},{key:"deleteComment",value:function(e,t){this.service.deleteComment({statusId:e,id:t}).subscribe((function(e){console.log("comment deleted",e)}))}},{key:"createComment",value:function(e){var t=this,n=e.payload;return this.service.createComment({statusId:this.id,text:n.text}).pipe(g(100),Object(l.a)((function(){return t.reset.next(!0)}))).subscribe()}},{key:"handleStatusAction",value:function(e){var t=this,n=e.type,r=e.payload;switch(n){case"DELETE":return this.service.deleteStatus(r).subscribe((function(){t.router.navigate(["/feed"])}));case"LIKE":return console.log("LIKE not implemented yet");default:console.log("Unhandled action ".concat(n),r)}}}]),e}()).\u0275fac=function(e){return new(e||N)(f.Pb(a.a),f.Pb(a.b),f.Pb(d))},N.\u0275cmp=f.Jb({type:N,selectors:[["ng-component"]],decls:6,vars:3,consts:[[1,"row"],[1,"col-12","col-md-8","offset-md-2"],[4,"ngIf"],[1,"mb-3",3,"comment","deleteButton","action"],["class","alert alert-info",4,"ngIf"],[4,"ngFor","ngForOf"],["placeholder","Write your reply","submitButton","Comment",1,"mb-3",3,"avatar","reset$","action"],[1,"alert","alert-info"]],template:function(e,t){1&e&&(f.Vb(0,"div",0),f.Vb(1,"div",1),f.Vb(2,"ui-card"),f.Vb(3,"ui-card-body"),f.zc(4,B,7,6,"ng-container",2),f.gc(5,"async"),f.Ub(),f.Ub(),f.Ub(),f.Ub()),2&e&&(f.Bb(4),f.lc("ngIf",f.hc(5,1,t.data$)))},directives:[o.e,o.d,_.m,o.l,_.l,o.m],pipes:[_.b],encapsulation:2}),N);n.d(t,"FeedModule",(function(){return T}));var U,$=[{path:"",component:I},{path:":id",component:x}],T=((U=function e(){_classCallCheck(this,e)}).\u0275mod=f.Nb({type:U}),U.\u0275inj=f.Mb({factory:function(e){return new(e||U)},imports:[[o.i,a.f.forChild($)]]}),U)}}]);